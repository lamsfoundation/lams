<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
           				   http://www.springframework.org/schema/beans/spring-beans-4.0.xsd">

  	<bean id="hibernateProperties" class="org.springframework.beans.factory.config.PropertiesFactoryBean">
	  	<property name="properties">
		<props>
			<prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop>
			<prop key="hibernate.show_sql">false</prop>
			<prop key="hibernate.c3p0.minPoolSize">5</prop>
			<prop key="hibernate.c3p0.maxPoolSize">20</prop>
			<prop key="hibernate.c3p0.timeout">1800</prop>
			<prop key="hibernate.c3p0.max_statement">50</prop>
			<prop key="hibernate.cache.use_second_level_cache">false</prop>
		</props>
		</property>
  	</bean>

	<!--  Transaction manager for all transactions involving the core classes or the content repository. 
		  For JBoss 5, it has been changed to Hibernate Transaction Manager, instead of JTA.
	
		  "autodetectTransactionManager" defaults to true so we don't need to include it.  		 	
	  	  But remember all application servers do not have the same JNDI name for their transaction manager!
	 -->
	<bean id="transactionManager" class="org.springframework.orm.hibernate3.HibernateTransactionManager">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>

	<!-- Local DataSource that works in any environment -->
	<bean id="localDataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
		<property name="driverClassName"><value>com.mysql.jdbc.Driver</value></property>
		<property name="url"><value>jdbc:mysql://localhost/lams?characterEncoding=utf8</value></property>
		<property name="username"><value>lams</value></property>
		<property name="password"><value>lamsdemo</value></property>
	</bean>

	<!-- ========================= GENERAL DEFINITIONS ========================= -->

	<import resource="messageContext.xml"/>

	<!-- ========================= RESOURCE DEFINITIONS ========================= -->

 	<!-- Hibernate SessionFactory. Since LAMS 2.3 it is used in all tools and other parts of LAMS,
 		 rather than several local Session Factiories.
 	-->
	<bean id="coreSessionFactory" class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">
		<property name="dataSource"><ref bean="localDataSource"/></property>
		<property name="mappingLocations">
			<list>
				<!-- usermanagement related mapping files -->	
				<value>classpath:org/lamsfoundation/lams/usermanagement/AuthenticationMethod.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/usermanagement/AuthenticationMethodType.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/usermanagement/Organisation.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/usermanagement/OrganisationState.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/usermanagement/OrganisationType.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/usermanagement/Role.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/usermanagement/Privilege.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/usermanagement/RolePrivilege.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/usermanagement/User.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/usermanagement/ForgotPasswordRequest.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/usermanagement/UserOrganisation.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/usermanagement/UserOrganisationCollapsed.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/usermanagement/UserOrganisationRole.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/usermanagement/Workspace.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/usermanagement/WorkspaceFolder.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/usermanagement/WorkspaceWorkspaceFolder.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/usermanagement/SupportedLocale.hbm.xml</value>
				
				<!-- learning design related mapping files -->
				<value>classpath:org/lamsfoundation/lams/learningdesign/Activity.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/learningdesign/BranchActivityEntry.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/learningdesign/BranchCondition.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/learningdesign/Group.hbm.xml</value>		
				<value>classpath:org/lamsfoundation/lams/learningdesign/GroupUser.hbm.xml</value>			
				<value>classpath:org/lamsfoundation/lams/learningdesign/Grouping.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/learningdesign/LearningDesign.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/learningdesign/Competence.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/learningdesign/CompetenceMapping.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/learningdesign/LearningLibrary.hbm.xml</value>	
				<value>classpath:org/lamsfoundation/lams/learningdesign/Transition.hbm.xml</value>	
				<value>classpath:org/lamsfoundation/lams/learningdesign/License.hbm.xml</value>	
				<value>classpath:org/lamsfoundation/lams/learningdesign/ActivityEvaluation.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/learningdesign/DataFlowObject.hbm.xml</value>
				
				
				<!-- lesson related mapping files-->
				<value>classpath:org/lamsfoundation/lams/lesson/LearnerProgress.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/lesson/Lesson.hbm.xml</value>
 				<value>classpath:org/lamsfoundation/lams/lesson/CompletedActivityProgress.hbm.xml</value>
 				
				<!-- Workspace related mapping files -->
				<value>classpath:org/lamsfoundation/lams/workspace/WorkspaceFolderContent.hbm.xml</value>
				
				<!-- Theme related mapping files -->
				<value>classpath:org/lamsfoundation/lams/themes/Theme.hbm.xml</value>
				
				<!-- Core Notebook Service related mapping files -->
				<value>classpath:org/lamsfoundation/lams/notebook/model/NotebookEntry.hbm.xml</value>
				
				<!-- Presence Chat Service related mapping files -->
				<value>classpath:org/lamsfoundation/lams/presence/model/PresenceChatMessage.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/presence/model/PresenceChatRoster.hbm.xml</value>
				
				<!-- Event notification service related mapping files-->
				<value>classpath:org/lamsfoundation/lams/events/Event.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/events/Subscription.hbm.xml</value>
				
				<!--  Configuration related mapping files -->
				<value>classpath:org/lamsfoundation/lams/config/ConfigurationItem.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/config/Registration.hbm.xml</value>
				
				<!-- Integration related mapping files -->
				<value>classpath:org/lamsfoundation/lams/integration/ExtServerOrgMap.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/integration/ExtCourseClassMap.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/integration/ExtUserUseridMap.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/integration/ExtServerToolAdapterMap.hbm.xml</value>
				
				<!-- Pedagogical Planner related mapping files-->
				<value>classpath:org/lamsfoundation/lams/planner/PedagogicalPlannerSequenceNode.hbm.xml</value>
				
				<!-- Gradebook related mapping files -->
				<value>classpath:org/lamsfoundation/lams/gradebook/GradebookUserActivity.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/gradebook/GradebookUserLesson.hbm.xml</value>
				
				<value>classpath:org/lamsfoundation/lams/contentrepository/CrCredential.hbm.xml</value>
 				<value>classpath:org/lamsfoundation/lams/contentrepository/CrNode.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/contentrepository/CrNodeVersion.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/contentrepository/CrNodeVersionProperty.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/contentrepository/CrWorkspace.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/contentrepository/CrWorkspaceCredential.hbm.xml</value>
				
				<value>classpath:org/lamsfoundation/lams/tool/BasicToolVO.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/tool/SystemTool.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/tool/Tool.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/tool/ToolContent.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/tool/ToolImportSupport.hbm.xml</value>
				<value>classpath:org/lamsfoundation/lams/tool/ToolSession.hbm.xml</value>
			</list>
		</property>
		<property name="hibernateProperties"><ref bean="hibernateProperties"/></property>
	</bean>
	
	<!-- ========================= BUSINESS OBJECT DEFINITIONS ========================= -->

	<!-- LAMS primary business object: Hibernate implementation -->
	<bean id="userManagementServiceTarget" class="org.lamsfoundation.lams.usermanagement.service.UserManagementService"
		scope="prototype"
	>
		<property name="baseDAO"><ref bean="baseDAO"/></property>
		<property name="groupDAO"><ref bean="groupDAO"/></property>
		<property name="roleDAO"><ref bean="roleDAO"/></property>
		<property name="organisationDAO"><ref bean="organisationDAO"/></property>
		<property name="userOrganisationDAO"><ref bean="userOrganisationDAO"/></property>
		<property name="messageService"><ref bean="commonMessageService"/></property>
	</bean>	
	
	<!-- Transactional proxy for the user management primary business object -->
	<bean id="userManagementService" class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean">
		<property name="transactionManager"><ref bean="transactionManager"/></property>
		<property name="target"><ref bean="userManagementServiceTarget"/></property>
		<property name="proxyTargetClass"><value>true</value></property> 
		<property name="transactionAttributes">
			<props>
				<prop key="get*">PROPAGATION_REQUIRED</prop>
				<prop key="find*">PROPAGATION_REQUIRED</prop>
				<prop key="save*">PROPAGATION_REQUIRED</prop>
				<prop key="create*">PROPAGATION_REQUIRED</prop>
				<prop key="update*">PROPAGATION_REQUIRED</prop>
				<prop key="remove*">PROPAGATION_REQUIRED</prop>
				<prop key="delete*">PROPAGATION_REQUIRED</prop>
				<prop key="disable*">PROPAGATION_REQUIRED</prop>
				<prop key="set*">PROPAGATION_REQUIRED</prop>
				<prop key="userHasData">PROPAGATION_REQUIRED</prop>
			</props>
		</property>
	</bean>
	
	<bean id="learningDesignServiceTarget" class="org.lamsfoundation.lams.learningdesign.service.LearningDesignService">
		<property name="messageService"><ref bean="commonMessageService"/></property>
		<property name="learningDesignDAO"><ref bean="learningDesignDAO"/></property>
		<property name="activityDAO"><ref bean="activityDAO"/></property>
		<property name="groupingDAO"><ref bean="groupingDAO"/></property>
		<property name="learningLibraryDAO"><ref bean="learningLibraryDAO"/></property>
		<property name="toolActMessageService"><ref bean="loadedMessageSourceService"/></property>
	</bean>
	
	<bean id="learningDesignService" class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean">
		<property name="transactionManager"><ref bean="transactionManager"/></property>
		<property name="target"><ref bean="learningDesignServiceTarget"/></property>
		<property name="proxyTargetClass"><value>true</value></property> 
		<property name="transactionAttributes">
			<props>
				<prop key="validateLearningDesign">PROPAGATION_REQUIRED</prop>
				<prop key="setValid">PROPAGATION_REQUIRED</prop>
			</props>
		</property>
	</bean>
	
	<bean id="themeServiceTarget" class="org.lamsfoundation.lams.themes.service.ThemeService">
		<property name="themeDAO"><ref bean="themeDAO"/></property>
		<property name="userManagementService"><ref bean="userManagementService"/></property>
		<property name="messageService"><ref bean="commonMessageService"/></property>
	</bean>
	
	<bean id="themeService" class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean">
		<property name ="transactionManager"><ref bean ="transactionManager"/></property>
		<property name ="target"><ref bean="themeServiceTarget"/></property>
		<property name="proxyTargetClass"><value>true</value></property> 
		<property name="transactionAttributes">
			<props>
				<prop key="get*">PROPAGATION_REQUIRED</prop>
				<prop key="store*">PROPAGATION_REQUIRED</prop>
				<prop key="set*">PROPAGATION_REQUIRED</prop>
			</props>
		</property>
	</bean>
	
	<bean id="exportToolContentServiceTarget" class="org.lamsfoundation.lams.learningdesign.service.ExportToolContentService">
		<property name="activityDAO"><ref bean="activityDAO"/></property>
		<property name="toolDAO"><ref bean="toolDAO"/></property>
		<property name="toolImportSupportDAO"><ref bean="toolImportSupportDAO"/></property>
		<property name="toolContentDAO"><ref bean="toolContentDAO"/></property>
		<property name="systemToolDAO"><ref bean="systemToolDAO"/></property>
		<property name="baseDAO"><ref bean="baseDAO"/></property>
		<property name="licenseDAO"><ref bean="licenseDAO"/></property>
		<property name="groupingDAO"><ref bean="groupingDAO"/></property>
		<property name="transitionDAO"><ref bean="transitionDAO"/></property>
		<property name="learningDesignDAO"><ref bean="learningDesignDAO"/></property>
		<property name="learningLibraryDAO"><ref bean="learningLibraryDAO"/></property>
	</bean>
	
	<bean id="exportToolContentService" class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean">
		<property name ="transactionManager"><ref bean ="transactionManager"/></property>
		<property name ="target"><ref bean="exportToolContentServiceTarget"/></property>
		
		<!-- TransactionProxyFactoryBean by default just proxies all interfaces implemented by the target object -->
		<!-- AuthoringService is class so needs to be proxied via CGLIB -->
		<!-- Specify "proxyTargetClass" = "true" to generate a CGLIB proxy-->
		<property name="proxyTargetClass"><value>true</value></property>     
		
		<property name="transactionAttributes">
			<props>
				<prop key="save*">PROPAGATION_REQUIRED</prop>
				<prop key="remove*">PROPAGATION_REQUIRED</prop>
				<prop key="export*">PROPAGATION_REQUIRED,+java.lang.Exception</prop>
				<prop key="import*">PROPAGATION_REQUIRED,+java.lang.Exception</prop>
			</props>
		</property>
	</bean>
	
    <!--  Processes a LAMS 1.0.2 import file. Called by exportToolContentService -->
	<bean id="ld102Importer" class="org.lamsfoundation.lams.learningdesign.service.LD102Importer" scope="prototype">
		<property name="learningDesignService"><ref bean="learningDesignService"/></property>
		<property name="messageService"><ref bean="commonMessageService"/></property>
		<property name="baseDAO"><ref bean="baseDAO"/></property>
		<property name="learningLibraryDAO"><ref bean="learningLibraryDAO"/></property>
		<property name="learningDesignDAO"><ref bean="learningDesignDAO"/></property>
		<property name="activityDAO"><ref bean="activityDAO"/></property>
		<property name="toolDAO"><ref bean="toolDAO"/></property>
		<property name="toolImportSupportDAO"><ref bean="toolImportSupportDAO"/></property>
		<property name="toolContentDAO"><ref bean="toolContentDAO"/></property>
		<property name="systemToolDAO"><ref bean="systemToolDAO"/></property>
	</bean>
	
	<!--  Access a message service related to a programatically loaded message file. -->
	<!--  Can be used to arbitrarily access any message file that is on the classpath -->
	<!--  as long as you know the file's name and full path.                          -->
	<bean id="loadedMessageSourceService" class="org.lamsfoundation.lams.util.LoadedMessageSourceService">
    </bean>
    	
    <!--  Each message service created by loadedMessageService is a ResourceBundleMessageSource -->
	<bean id="loadedMessageSource" class="org.springframework.context.support.ResourceBundleMessageSource" scope="prototype">
	</bean>
			
	<!--  Core Notebook Service -->
	<bean id="coreNotebookServiceTarget" class="org.lamsfoundation.lams.notebook.service.CoreNotebookService">
		<property name="messageService"><ref bean="commonMessageService"/></property>
		<property name="userManagementService"><ref bean="userManagementService"/></property>
		<property name="notebookEntryDAO"><ref bean="notebookEntryDAO" /></property>
	</bean>
	
	<!--  Presence Chat Service -->
	<bean id="presenceChatService" class="org.lamsfoundation.lams.presence.service.PresenceChatService">
		<property name="presenceChatDAO"><ref bean="presenceChatDAO" /></property>
	</bean>
	
	<bean id="coreNotebookService" class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean">
		<property name ="transactionManager"><ref bean ="transactionManager"/></property>
		<property name ="target"><ref bean="coreNotebookServiceTarget"/></property>
		
		<!-- TransactionProxyFactoryBean by default just proxies all interfaces implemented by the target object -->
		<!-- AuthoringService is class so needs to be proxied via CGLIB -->
		<!-- Specify "proxyTargetClass" = "true" to generate a CGLIB proxy-->
		<property name="proxyTargetClass"><value>true</value></property>     
		
		<property name="transactionAttributes">
			<props>
				<prop key="get*">PROPAGATION_REQUIRED</prop>
				<prop key="update*">PROPAGATION_REQUIRED</prop>
				<prop key="save*">PROPAGATION_REQUIRED</prop>
				<prop key="create*">PROPAGATION_REQUIRED</prop>
			</props>
		</property>
	</bean>
	
	<!-- Event notification Service -->

	 <bean id="scheduler" class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
        <property name="applicationContextSchedulerContextKey" value="context.central"/>
    	<property name="quartzProperties">
			<props>
				<prop key="org.quartz.jobStore.class">org.springframework.scheduling.quartz.LocalDataSourceJobStore</prop>
				<prop key="org.quartz.jobStore.driverDelegateClass">org.quartz.impl.jdbcjobstore.StdJDBCDelegate</prop>
				<prop key="org.quartz.jobStore.tablePrefix">lams_qtz_</prop>
			</props>
		</property> 
		<property name="dataSource"><ref bean="localDataSource"/></property>     
    </bean>


    <bean id="eventNotificationService" class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean">
		<property name ="transactionManager"><ref bean="transactionManager"/></property>
		<property name ="target">
			<bean class="org.lamsfoundation.lams.events.EventNotificationService">
				<property name="eventDAO"><ref bean="eventDAO" /></property>
				<property name="userManagementService"><ref bean="userManagementService"/></property>
				<constructor-arg>
         		  <ref bean="scheduler"/>
        		</constructor-arg>
			</bean>	
		</property>  
		<property name="transactionAttributes">
			<props>
				<prop key="createEvent">PROPAGATION_REQUIRED</prop>
				<prop key="deleteEvent">PROPAGATION_REQUIRED</prop>
				<prop key="sendMessage">PROPAGATION_REQUIRED</prop>
				<prop key="subscribe">PROPAGATION_REQUIRED</prop>
				<prop key="unsubscribe">PROPAGATION_REQUIRED</prop>
				<prop key="trigger*">PROPAGATION_REQUIRED</prop>
				<prop key="saveEvent">PROPAGATION_SUPPORTS</prop>
			</props>
		</property>
	</bean>
	
	<!--  Configuration service -->
	<bean id="configurationService" class="org.lamsfoundation.lams.util.Configuration">
		<property name="configurationDAO"><ref bean="configurationDAO" /></property>
		<property name="registrationDAO"><ref bean="registrationDAO" /></property>
	</bean>
	
	<!-- auditing service -->
	<bean id="auditService" class="org.lamsfoundation.lams.util.audit.AuditService" >
		<property name="messageService"><ref bean="commonMessageService"/></property>
    </bean>

	<!-- Learning Design related beans-->
	
	<bean id="activityDAO" class="org.lamsfoundation.lams.learningdesign.dao.hibernate.ActivityDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>
	<bean id="branchActivityEntryDAO" class="org.lamsfoundation.lams.learningdesign.dao.hibernate.BranchActivityEntryDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>
	<bean id="learningLibraryDAO" class="org.lamsfoundation.lams.learningdesign.dao.hibernate.LearningLibraryDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>
	<bean id="learningDesignDAO" class="org.lamsfoundation.lams.learningdesign.dao.hibernate.LearningDesignDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>	
	<bean id="transitionDAO" class="org.lamsfoundation.lams.learningdesign.dao.hibernate.TransitionDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>	
	<bean id="groupingDAO" class="org.lamsfoundation.lams.learningdesign.dao.hibernate.GroupingDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>	
	<bean id="groupDAO" class="org.lamsfoundation.lams.learningdesign.dao.hibernate.GroupDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>
	<bean id="licenseDAO" class="org.lamsfoundation.lams.learningdesign.dao.hibernate.LicenseDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>	
	
	<!--User management related beans -->
	
	<bean id="baseDAO" class="org.lamsfoundation.lams.dao.hibernate.BaseDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>
	<!--  Theme beans -->
	<bean id="themeDAO" class="org.lamsfoundation.lams.themes.dao.hibernate.CSSThemeDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>
	
	<bean id="roleDAO" class="org.lamsfoundation.lams.usermanagement.dao.hibernate.RoleDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>
	
	<bean id="organisationDAO" class="org.lamsfoundation.lams.usermanagement.dao.hibernate.OrganisationDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>
	
	<bean id="userOrganisationDAO" class="org.lamsfoundation.lams.usermanagement.dao.hibernate.UserOrganisationDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>
	
	<!--Event service related beans -->
	<bean id="eventDAO" class="org.lamsfoundation.lams.events.dao.hibernate.EventDAOHibernate">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>
	
	<!-- Core Notebook related beans -->
	<bean id="notebookEntryDAO" class="org.lamsfoundation.lams.notebook.dao.hibernate.NotebookEntryDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>	
	
	<!-- Presence Chat related beans -->
	<bean id="presenceChatDAO" class="org.lamsfoundation.lams.presence.dao.hibernate.PresenceChatDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>	
	
	<!--  Configuration related beans -->
	<bean id="configurationDAO" class="org.lamsfoundation.lams.config.dao.hibernate.ConfigurationDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>
	<bean id="registrationDAO" class="org.lamsfoundation.lams.config.dao.hibernate.RegistrationDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>
	
	<!--  Competence related beans -->
	<bean id="competenceDAO" class="org.lamsfoundation.lams.learningdesign.dao.hibernate.CompetenceDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>
	<bean id="competenceMappingDAO" class="org.lamsfoundation.lams.learningdesign.dao.hibernate.CompetenceMappingDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>
	
	<!--  Pedagogical Planner related beans -->
	<bean id="pedagogicalPlannerDAO" class="org.lamsfoundation.lams.planner.dao.hibernate.PedagogicalPlannerDAOHibernate">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>
	
	<!--  Gradebook related beans -->
	<bean id="gradebookDAO" class="org.lamsfoundation.lams.gradebook.dao.hibernate.GradebookDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>
	
	<!--  Data flow related beans -->
	<bean id="dataFlowDAO" class="org.lamsfoundation.lams.learningdesign.dao.hibernate.DataFlowDAO">
		<property name="sessionFactory"><ref bean="coreSessionFactory"/></property>
	</bean>
	
	<!--  System Session bean -->
	<bean id="SystemSession"
	    class="org.lamsfoundation.lams.web.session.SessionManager"
	    init-method="init"
	    destroy-method="destroy"
		>
		<property name="monitorPeriod"><value>60</value></property>
	</bean>
	
	<!-- Cache Manager bean. cacheObjectName should be the same value as hibernate.treecache.objectName -->
	<bean id="cacheManager" class="org.lamsfoundation.lams.cache.CacheManager">
		<property name="cacheObjectName"><value>jboss.cache:service=TreeCache</value></property>
	</bean>
	
</beans>