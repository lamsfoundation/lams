<project name="create-database" basedir="." >
	<!-- begin properties *******************************************************************************************-->
	<!-- import properties from the specified file -->

	<property file="../lams.properties"/>
	
	<target name="create-database" description="Create the core lams database">
		<copy todir="../database" overwrite="true">
			<fileset dir="../sql-scripts">
				<include name="create-database.sql"/>
			</fileset>
			<filterset>
				<filter token="DB_NAME" value="${DB_NAME}" />
                		<filter token="DB_USER" value="${DB_USER}" />
                		<filter token="DB_PASS" value="${DB_PASS}" />
				<filter token="SQL_GRANT" value="${SQL_GRANT}" />
			</filterset>
		</copy>

		<sql driver="com.mysql.jdbc.Driver" 
			classpath="../assembly/lams.ear/mysql-connector-java-3.1.12-bin.jar" 
			url="${MYSQL_DB_URL}" 
			userid="root" 
			password="${DB_ROOT_PASSWORD}"
			encoding="utf8"
			onerror="continue">
			<transaction src="../database/create-database.sql" />
                </sql>

	</target>

	
	<target name="fill-database" description="fills the database">
		<sql driver="com.mysql.jdbc.Driver"
                        classpath="../assembly/lams.ear/mysql-connector-java-3.1.12-bin.jar"
                        url="${SQL_URL}"
                        userid="${DB_USER}"
                        password="${DB_PASS}"
                        encoding="utf8"
                        onerror="continue">
                        <transaction src="../database/lams.dump" />
                        <transaction src="../sql-scripts/setLamsConfiguration.sql"/>
                </sql>
	</target>
</project>
